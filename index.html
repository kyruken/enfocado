
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello from Electron renderer!</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
  <body>

		<div class="container text-center">
				<div id="display">00:00:00</div>
				<div class="row align-items-start">
					<div class="col">
						<button id="startBtn">Start</button>
					</div>
					<div class="col">
						<button id="pauseBtn" >Pause</button>
					</div>
					<div class="col">
						<button id="splitBtn" disabled>Split</button>
					</div>
					<div class="col">
						<button id="resetBtn" disabled>Reset</button>
					</div>
				</div>
			</div>
		</div>

    <button id="stopSessionBtn" class="btn btn-primary">Stop Sessions</button>

		<ul id="splits" styles="--bs-bg-opacity: 1; background-color: rgba(var(--bs-tertiary-bg-rgb), var(--bs-bg-opacity)) !important;"></ul>

		<hr>

		<!-- <div class="center text-center">
			<p id="oldDescription">Old description </p>
			<button id="thisButton" class='btn btn-primary'>Create new ccccccc</button>

			<button id="newProjectButton" class='btn btn-primary'>Create new project</button>
			<form id="form" style="display:none;">
				<input type="text" id="projectTextbox">Type project here</input>
				<button type="submit">Submit</button>
			</form>

			<div class="dropdown">
				<button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
					Dropdown Button
				</button>

				<ul id="projectsDropdown" class="dropdown-menu" aria-labelledby="dropdownMenuButton">
					<li><a class="dropdown-item" href="#">Action</a></li>
					<li><a class="dropdown-item" href="#">Another action</a></li>
					<li><a class="dropdown-item" href="#">Something else here</a></li>
				</ul>
			</div>
		</div> -->
    

    <script src="renderer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/timer.js@latest/dist/timer.min.js"></script>

 <script>

    const display = document.getElementById("display");
    const splits = document.getElementById("splits");
    const startBtn = document.getElementById("startBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const splitBtn = document.getElementById("splitBtn");
    const resetBtn = document.getElementById("resetBtn");

    const stopSessionBtn = document.getElementById("stopSessionBtn");

    let startTime = 0;
    let elapsed = 0;
    let interval = null;
    let running = false;

    document.getElementById('stopSessionBtn').addEventListener('click', () => {
      const stopwatchData = { elapsedTime: elapsed };
      window.electronAPI.saveStopwatch(stopwatchData);
    });

    stopSessionBtn.addEventListener("click", () => {
      //Change page to details page
      console.log("Change to details page");
    })

    function formatTime(ms) {
      const totalSeconds = Math.floor(ms / 1000);
      const hrs = Math.floor(totalSeconds / 3600);
      const mins = Math.floor((totalSeconds % 3600) / 60);
      const secs = totalSeconds % 60;
      return [
        hrs.toString().padStart(2, '0'),
        mins.toString().padStart(2, '0'),
        secs.toString().padStart(2, '0')
      ].join(':');
    }

    function updateDisplay() {
      const now = Date.now();
      const diff = now - startTime + elapsed;
      display.textContent = formatTime(diff);
    }

    startBtn.addEventListener('click', () => {
      if (!running) {
        startTime = Date.now();
        interval = setInterval(updateDisplay, 100);
        running = true;
        startBtn.disabled = true;
        pauseBtn.disabled = false;
        splitBtn.disabled = false;
        resetBtn.disabled = false;
      }
    });

    pauseBtn.addEventListener('click', () => {
      if (running) {
        clearInterval(interval);
        elapsed += Date.now() - startTime;
        running = false;
        startBtn.disabled = false;
        pauseBtn.disabled = true;
      }
    });

    resetBtn.addEventListener('click', () => {
      clearInterval(interval);
      elapsed = 0;
      startTime = 0;
      running = false;
      display.textContent = '00:00:00';
      splits.innerHTML = '';
      startBtn.disabled = false;
      pauseBtn.disabled = true;
      splitBtn.disabled = true;
      resetBtn.disabled = true;
    });

    splitBtn.addEventListener('click', () => {
      const li = document.createElement('li');
      li.textContent = 'Split: ' + display.textContent;
      splits.appendChild(li);
    });
  </script> 

  </body>
</html>
